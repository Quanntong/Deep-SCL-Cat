# Deep-SCL-Cat: 基于SCL-90心理评估的学业预警系统

## 项目简介

Deep-SCL-Cat 是一个基于 SCL-90 心理评估数据的学业预警系统，采用 CatBoost 机器学习算法进行高危学生识别。系统通过混合专家架构，实现了数据预处理、K-Means聚类、CatBoost预测和阈值优化的完整工作流。

## 核心功能

### 1. 数据预处理与语义化
- 自动处理缺失值（中位数填充）
- SCL-90因子语义化映射（score1-score10 → 中文心理学因子名）
- 数据标准化与特征工程

### 2. 异质性分层分析
- 基于K-Means的无监督聚类，发现潜在心理画像模式
- 将学生分为3个心理画像簇：健康型、中间型、高症状型
- 聚类标签作为先验知识融入预测模型

### 3. CatBoost混合专家预测
- 采用Ordered Boosting机制对抗小样本过拟合
- 自动处理类别不平衡（`auto_class_weights='Balanced'`）
- 支持类别特征（Cluster_Label）的原生处理

### 4. 高召回率阈值优化
- "宁可误报，不可漏报"的业务原则
- 基于P-R曲线寻找Recall > 95%的最佳阈值（0.513）
- 确保高危学生识别率最大化

### 5. 可解释性与可视化
- SHAP（SHapley Additive exPlanations）值分析
- 特征重要性排名与依赖关系可视化
- 交互式Web界面（单体预测 + 批量筛查）

## 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                    Deep-SCL-Cat 工作流                        │
├───────────────┬──────────────┬─────────────┬───────────────┤
│   数据层       │   聚类层      │   模型层     │   策略层       │
│  (Data Layer) │ (Cluster Layer)│ (Model Layer)│ (Strategy Layer)│
├───────────────┼──────────────┼─────────────┼───────────────┤
│ 1. 数据加载    │ 3. 特征选择   │ 5. 模型训练  │ 7. 阈值寻优    │
│ 2. 数据清洗    │ 4. K-Means聚类│ 6. 模型评估  │ 8. 策略部署    │
└───────────────┴──────────────┴─────────────┴───────────────┘
```

## 快速开始

### 环境要求
- Python 3.8+
- 依赖包：`pip install -r requirements.txt`

### 安装步骤
1. 克隆仓库：
   ```bash
   git clone https://github.com/Quanntong/Deep-SCL-Cat.git
   cd Deep-SCL-Cat
   ```

2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

3. 运行完整分析流程：
   ```bash
   python main.py
   ```

4. 启动Web界面：
   ```bash
   streamlit run app.py
   ```

5. 访问Web界面：
   - 打开浏览器访问：http://localhost:8501
   - 选择侧边栏页面：
     - **模型概览**：查看模型训练结果和可视化图表
     - **单体预测模拟**：输入学生特征进行实时风险评估
     - **批量智能筛查**：上传CSV/Excel文件进行批量筛查

## 项目结构

```
Deep-SCL-Cat/
├── README.md                    # 项目说明文档
├── requirements.txt             # Python依赖包列表
├── main.py                      # 主程序入口
├── app.py                       # Streamlit Web界面
├── src/                         # 源代码目录
│   ├── __init__.py
│   ├── config.py               # 配置文件（路径、参数、SCL-90映射）
│   ├── data_loader.py          # 数据加载与预处理
│   ├── feature_cluster.py      # K-Means聚类分析
│   ├── model_catboost.py       # CatBoost模型训练
│   ├── strategy_recall.py      # 阈值寻优策略
│   └── explainability.py       # SHAP可解释性分析
├── data/                        # 数据目录（.gitignore排除）
│   ├── raw/                    # 原始数据
│   └── processed/              # 处理后的数据
├── outputs/                     # 输出目录（.gitignore排除）
│   ├── catboost_model.cbm      # CatBoost模型文件
│   ├── scaler.pkl              # 标准化器
│   ├── kmeans.pkl              # K-Means模型
│   ├── pr_curve.png            # P-R曲线图
│   └── shap_*.png              # SHAP可视化图表
└── logs/                        # 日志目录（.gitignore排除）
```

## 技术特点

### 算法优势
1. **CatBoost算法**：
   - Ordered Boosting机制有效对抗过拟合
   - 原生支持类别特征，无需独热编码
   - 自动处理缺失值，内置正则化

2. **混合专家架构**：
   - 模块化设计，各专家专注于特定任务
   - 流水线处理，确保数据一致性
   - 易于扩展和维护

3. **可解释性设计**：
   - SHAP值提供特征级别的解释
   - 可视化图表直观展示模型决策过程
   - 心理学专业术语映射，提高可理解性

### 业务价值
1. **高召回率保障**：优先识别高危学生，降低漏报风险
2. **批量处理能力**：支持大规模学生群体筛查
3. **实时交互界面**：提供即时的风险评估和决策支持
4. **结果可解释性**：帮助教育工作者理解预测依据

## 使用示例

### 单体预测
1. 在Web界面中选择"🎓 单体预测模拟"
2. 输入学生的SCL-90因子分和其他特征
3. 点击"🚀 开始评估"查看预测结果
4. 系统显示风险概率、心理画像簇和处理建议

### 批量筛查
1. 在Web界面中选择"📂 批量智能筛查"
2. 上传包含学生SCL-90因子分的CSV/Excel文件
3. 系统自动识别特征列并进行批量预测
4. 下载高危学生名单和完整预测结果

## 学术应用

本项目已撰写详细的毕业论文第三章《系统设计与算法实现》，包含：
- 混合专家架构设计
- 数据预处理与语义化策略
- K-Means异质性分层原理
- CatBoost预测模型数学推导
- 高召回率阈值优化方法
- SHAP可解释性分析理论

详见：`第三章_系统设计与算法实现.md`

## 许可证

本项目采用 MIT 许可证。详见 LICENSE 文件。

## 贡献指南

欢迎提交 Issue 和 Pull Request 来改进本项目。

## 联系方式

如有问题或建议，请通过 GitHub Issues 联系我们。

---

**注意**：本项目为学术研究用途，实际应用时请结合专业心理学评估和人工判断。
